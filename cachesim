.data 

buffer: .space 1024

fnf:	.ascii  "The file was not found: "
file:	.asciiz	"/Users/dylan5394/Desktop/ee352final/tracefile.txt"
cont:	.ascii  "File contents: "

#array order: line size, data size, miss penalty
X: .word 2, 64, 5
.align 4
cache: .space 1000

.text 

main:

fill:
li $t1, 0 # temp var counter for loop
li $t2, 100 # exit condition loop 100 times
li $t3, 0 #array access counter

la $t0, cache
add $t3, $t0, $0    # load address of array into $t3
loop:
    beq $t2, $t1, escape #at 10 we go to Exit, defined below
    #access array
    li $v0, 15 #set value to store 
    sw $v0, ($t3)       # put number generated into array[n]
    addi $t3, $t3, 4    # next address   
    addi $t1, $t1, 1 #increment counter
    j loop #jumps back to the top of loop

escape:
open:
	li	$v0, 13		# Open File Syscall
	la	$a0, file	# Load File Name
	li	$a1, 0		# Read-only Flag
	li	$a2, 0		# (ignored)
	syscall
	move	$s6, $v0	# Save File Descriptor
	blt	$v0, 0, err	# Goto Error
 
# Read Data
read:
	li	$v0, 14		# Read File Syscall
	move	$a0, $s6	# Load File Descriptor
	la	$a1, buffer	# Load Buffer Address
	li	$a2, 1024	# Buffer Size
	syscall
 
# Print Data
print:
	li	$v0, 4		# Print String Syscall
	la	$a0, buffer	# Load Contents String
	syscall
 
# Close File
close:
	li	$v0, 16		# Close File Syscall
	move	$a0, $s6	# Load File Descriptor
	syscall
	j	done		# Goto End
 
# Error
err:
	li	$v0, 4		# Print String Syscall
	la	$a0, fnf	# Load Error String
	syscall
 
# Done
done:
	li	$v0, 10		# Exit Syscall
	syscall

li $v0, 16 #system call for close file
move $a0, $s6 #file descriptor to close
syscall
